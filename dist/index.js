(()=>{"use strict";const t=function(){function t(){this.observers=[]}return t.prototype.attach=function(t){this.observers.findIndex((function(e){return e.data===t.data}))>=0||this.observers.push(t)},t.prototype.dettach=function(t){this.observers.filter((function(e){return e!==t}))},t.prototype.notify=function(t){this.observers.forEach((function(e){e.update(t)}))},t}(),e=function(){function t(t){this.data=t}return t.prototype.update=function(t){console.log("updated: ".concat(this.data,"->").concat(t)),this.data=t},t}(),n=function(){function t(){}return t.text=function(e,n,i){t.bind(e,n,i,"text")},t.html=function(e,n,i){t.bind(e,n,i,"model")},t.model=function(e,n,i){var o=this;t.bind(e,n,i,"html");var r=this._getVMVal(n,i);e.addEventListener("input",(function(t){var e=t.target.value;r!==e&&(o._setVMVal(n,i,e),r=e)}))},t.class=function(e,n,i){t.bind(e,n,i,"class")},t.bind=function(e,n,i,o){var r=t.updater[o+"Updater"];r&&r(e,t._getVMVal(n,i)),console.log("TODO: finish the bind")},t.eventHandler=function(t,e,n,i){var o=i.split(":")[1],r=e.$options.methods&&e.$options.methods[n];o&&r&&t.addEventListener(o,r.bind(e),!1)},t._getVMVal=function(t,e){var n=t;return(e=e.split(".")).forEach((function(t){n=n[t]})),n},t._setVMVal=function(t,e,n){var i=t;(e=e.split(".")).forEach((function(t,o){o<e.length-1?i=i[t]:i[t]=n}))},t.updater={textUpdater:function(t,e){t.textContent=void 0===e?"":e},htmlUpdater:function(t,e){t.innerHTML=void 0===e?"":e},classUpdater:function(t,e,n){var i=t.className,o=(i=i.replace(n,"").replace(/\s$/,""))&&String(e)?" ":"";t.className=i+o+e},modelUpdater:function(t,e,n){t.value=void 0===e?"":e}},t}(),i=function(){function t(t,e){this.$el=this.isElementNode(t)?t:document.querySelector(t),this.$vm=e,this.$el&&(this.$fragment=this.node2Fragment(this.$el),this.compileElement(this.$fragment),this.$el.appendChild(this.$fragment))}return t.prototype.node2Fragment=function(t){for(var e,n=document.createDocumentFragment();e=t.firstChild;)n.appendChild(e);return n},t.prototype.compileElement=function(t){var e=this,n=t.childNodes;[].slice.call(n).forEach((function(t){var n=t.textContent;e.isElementNode(t)?e.compile(t):e.isTextNode(t)&&/\{\{(.*)\}\}/.test(n)&&(console.log(n),e.compileText(t,RegExp.$1.trim())),t.childNodes&&t.childNodes.length&&e.compileElement(t)}))},t.prototype.compile=function(t){var e=this,i=t.attributes;[].slice.call(i).forEach((function(i){var o=i.name;if(e.isDirective(o)){var r=i.value,s=o.substring(2);e.iseventDirectve(s)?n.eventHandler(t,e.$vm,r,s):n[s]&&n[s](t,e.$vm,r),t.removeAttribute(o)}}))},t.prototype.compileText=function(t,e){n.text(t,this.$vm,e)},t.prototype.isDirective=function(t){return 0==t.indexOf("v-")},t.prototype.iseventDirectve=function(t){return 1==t.indexOf("on")},t.prototype.isElementNode=function(t){return 1==t.nodeType},t.prototype.isTextNode=function(t){return 3==t.nodeType},t}();!function(){function n(t){this.$options=t,this.data=this.$options.data,this.subs=[],this.init()}n.prototype.init=function(){var t=this;Object.keys(this.data).forEach((function(e){t._proxyData(e)})),this._initComputed(),new i(this.$options.el,this)},n.prototype._proxyData=function(t){var e=this;Object.defineProperty(this,t,{configurable:!1,enumerable:!0,get:function(){return e.data[t]}})},n.prototype._initComputed=function(){var t=this,e=this.$options.computed;Object.keys(e).forEach((function(n){Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:e[n],set:function(){}})}))},n.prototype.observe=function(t){var e=this;Object.keys(t).forEach((function(n){e.defineProperty(t,n,t[n])}))},n.prototype.defineProperty=function(n,i,o){var r=new t;this.subs.push(r),r.attach(new e(o)),this.observe(o),Object.defineProperty(n,i,{enumerable:!0,configurable:!1,get:function(){return o},set:function(t){o!==t&&(r.notify(t),o=t)}})}}()})();